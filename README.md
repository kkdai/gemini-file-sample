# Gemini File Search API æ¸¬è©¦å·¥å…·

ä¸€å€‹ç°¡å–®çš„ç¶²é æ‡‰ç”¨ç¨‹å¼ï¼Œç”¨æ–¼æ¸¬è©¦ Google Gemini API çš„æª”æ¡ˆæœå°‹åŠŸèƒ½ï¼ˆFile Searchï¼‰ã€‚

## åŠŸèƒ½ç‰¹æ€§

- å»ºç«‹å’Œç®¡ç†æª”æ¡ˆæœå°‹å„²å­˜ç©ºé–“ï¼ˆFile Search Storesï¼‰
- **åˆ—å‡ºå„²å­˜ç©ºé–“ä¸­çš„æ‰€æœ‰æª”æ¡ˆ**ï¼ˆæ–°åŠŸèƒ½ï¼‰
- ä¸Šå‚³æª”æ¡ˆåˆ°æª”æ¡ˆæœå°‹å„²å­˜ç©ºé–“
- æ”¯æ´å…©ç¨®ä¸Šå‚³æ–¹å¼ï¼š
  - ç›´æ¥ä¸Šå‚³åˆ°å„²å­˜ç©ºé–“ï¼ˆä¸€æ­¥å®Œæˆï¼‰
  - åˆ†æ­¥ä¸Šå‚³å’ŒåŒ¯å…¥ï¼ˆæ”¯æ´è‡ªè¨‚è©®é‡‹è³‡æ–™ï¼‰
- æŸ¥è©¢æª”æ¡ˆæœå°‹å„²å­˜ç©ºé–“
- æª¢è¦–å¼•ç”¨è³‡è¨Šï¼ˆGrounding Metadataï¼‰
- æ”¯æ´è©®é‡‹è³‡æ–™ç¯©é¸
- å³æ™‚æ“ä½œè¨˜éŒ„é¡¯ç¤º
- **ç€è¦½å™¨ç«¯ API Key ç®¡ç†**ï¼ˆå„²å­˜æ–¼ localStorageï¼Œä¸æœƒå‚³é€åˆ°ä¼ºæœå™¨ï¼‰

## ç³»çµ±è¦æ±‚

- Python 3.8+
- Gemini API Key
- **é‡è¦ï¼š** File Search åŠŸèƒ½åƒ…æ”¯æ´ `gemini-2.5-flash` æˆ– `gemini-2.5-pro` æ¨¡å‹

## å®‰è£æ­¥é©Ÿ

### 1. è¤‡è£½æˆ–ä¸‹è¼‰å°ˆæ¡ˆ

```bash
cd gemini-file-sample
```

### 2. å»ºç«‹è™›æ“¬ç’°å¢ƒï¼ˆå»ºè­°ï¼‰

```bash
python3 -m venv venv
source venv/bin/activate  # macOS/Linux
# æˆ–
venv\Scripts\activate  # Windows
```

### 3. å®‰è£ç›¸ä¾å¥—ä»¶

```bash
pip install -r requirements.txt
```

**é‡è¦ç›¸ä¾å¥—ä»¶ï¼š**
- Flask==3.0.0
- google-genai>=1.49.0 ï¼ˆå¿…é ˆ >= 1.49.0 æ‰æ”¯æ´ file_search_storesï¼‰
- Werkzeug==3.0.1
- python-dotenv==1.0.0

### 4. åŸ·è¡Œæ‡‰ç”¨ç¨‹å¼

```bash
python3 app.py
```

ä¼ºæœå™¨å°‡åœ¨ **http://localhost:3000** å•Ÿå‹•

### 5. è¨­å®š API Key

1. é–‹å•Ÿç€è¦½å™¨è¨ªå•ï¼šhttp://localhost:3000
2. åˆ‡æ›åˆ°ã€Œâš™ï¸ è¨­å®šã€åˆ†é 
3. è¼¸å…¥æ‚¨çš„ Gemini API Key
4. é»æ“Šã€ŒğŸ’¾ å„²å­˜ API Keyã€

**å–å¾— API Keyï¼š** https://aistudio.google.com/app/apikey

**æ³¨æ„ï¼š** API Key åƒ…å„²å­˜åœ¨æ‚¨çš„ç€è¦½å™¨ localStorage ä¸­ï¼Œä¸æœƒå‚³é€åˆ°ä¼ºæœå™¨å„²å­˜ï¼Œç¢ºä¿å®‰å…¨æ€§ã€‚

## ä½¿ç”¨æŒ‡å—

### 1. æª”æ¡ˆæœå°‹å„²å­˜ç©ºé–“ç®¡ç†

#### å»ºç«‹å„²å­˜ç©ºé–“
1. åˆ‡æ›åˆ°ã€Œæª”æ¡ˆæœå°‹å„²å­˜ç©ºé–“ç®¡ç†ã€åˆ†é 
2. è¼¸å…¥å„²å­˜ç©ºé–“åç¨±ï¼ˆé¸å¡«ï¼Œé è¨­ç‚º my-file-search-storeï¼‰
3. é»æ“Šã€Œå»ºç«‹å„²å­˜ç©ºé–“ã€
4. **è¨˜ä¸‹ç”Ÿæˆçš„å®Œæ•´åç¨±**ï¼ˆæ ¼å¼ï¼š`fileSearchStores/xxx`ï¼‰
5. é»æ“Šã€ŒğŸ“‹ è¤‡è£½åç¨±ã€æŒ‰éˆ•å¯è‡ªå‹•è¤‡è£½ä¸¦å¡«å…¥ä¸Šå‚³è¡¨å–®

#### æª¢è¦–å„²å­˜ç©ºé–“æ¸…å–®
- é»æ“Šã€Œé‡æ–°æ•´ç†åˆ—è¡¨ã€æŒ‰éˆ•æŸ¥çœ‹æ‰€æœ‰å·²å»ºç«‹çš„å„²å­˜ç©ºé–“

#### æª¢è¦–å„²å­˜ç©ºé–“ä¸­çš„æª”æ¡ˆ
1. åœ¨ã€Œæª¢è¦–å„²å­˜ç©ºé–“ä¸­çš„æª”æ¡ˆã€å€åŸŸè¼¸å…¥å„²å­˜ç©ºé–“åç¨±ï¼ˆ`fileSearchStores/xxx`ï¼‰
2. é»æ“Šã€ŒğŸ“„ åˆ—å‡ºæª”æ¡ˆã€æŒ‰éˆ•
3. æŸ¥çœ‹è©²å„²å­˜ç©ºé–“ä¸­æ‰€æœ‰å·²åŒ¯å…¥çš„æª”æ¡ˆ
4. æª”æ¡ˆè³‡è¨ŠåŒ…æ‹¬ï¼š
   - æª”æ¡ˆåç¨±
   - é¡¯ç¤ºåç¨±
   - å»ºç«‹æ™‚é–“
   - æ›´æ–°æ™‚é–“

#### åˆªé™¤å„²å­˜ç©ºé–“
1. åœ¨åˆªé™¤å€åŸŸè¼¸å…¥å®Œæ•´çš„å„²å­˜ç©ºé–“åç¨±ï¼ˆ`fileSearchStores/xxx`ï¼‰
2. é»æ“Šã€Œåˆªé™¤å„²å­˜ç©ºé–“ã€
3. ç¢ºèªåˆªé™¤

### 2. æª”æ¡ˆä¸Šå‚³

#### æ–¹æ³• 1: ç›´æ¥ä¸Šå‚³åˆ°å„²å­˜ç©ºé–“ï¼ˆå»ºè­°ï¼‰
1. åˆ‡æ›åˆ°ã€Œæª”æ¡ˆä¸Šå‚³ã€åˆ†é 
2. è¼¸å…¥ç›®æ¨™å„²å­˜ç©ºé–“åç¨±ï¼ˆå¾å„²å­˜ç©ºé–“ç®¡ç†é é¢è¤‡è£½ï¼‰
3. ï¼ˆé¸å¡«ï¼‰è¼¸å…¥è‡ªè¨‚æª”æ¡ˆåç¨±ï¼ˆç”¨æ–¼å¼•ç”¨é¡¯ç¤ºï¼‰
4. é¸æ“‡è¦ä¸Šå‚³çš„æª”æ¡ˆ
5. é»æ“Šã€Œä¸Šå‚³ä¸¦åŒ¯å…¥ã€
6. ç­‰å¾…ä¸Šå‚³å’Œè™•ç†å®Œæˆï¼ˆå¤§æª”æ¡ˆå¯èƒ½éœ€è¦è¼ƒé•·æ™‚é–“ï¼‰

#### æ–¹æ³• 2: åˆ†æ­¥ä¸Šå‚³å’ŒåŒ¯å…¥
**æ­¥é©Ÿ 1 - ä¸Šå‚³æª”æ¡ˆï¼š**
1. è¼¸å…¥æª”æ¡ˆåç¨±
2. é¸æ“‡æª”æ¡ˆ
3. é»æ“Šã€Œä¸Šå‚³æª”æ¡ˆã€
4. è¤‡è£½å›å‚³çš„æª”æ¡ˆåç¨±

**æ­¥é©Ÿ 2 - åŒ¯å…¥åˆ°å„²å­˜ç©ºé–“ï¼š**
1. è¼¸å…¥ç›®æ¨™å„²å­˜ç©ºé–“åç¨±
2. è²¼ä¸Šä¸Šä¸€æ­¥å–å¾—çš„æª”æ¡ˆåç¨±
3. ï¼ˆé¸å¡«ï¼‰æ–°å¢è‡ªè¨‚è©®é‡‹è³‡æ–™ï¼š
   - é»æ“Šã€Œæ–°å¢è©®é‡‹è³‡æ–™ã€
   - è¼¸å…¥éµå€¼å°ï¼ˆä¾‹å¦‚ï¼šauthor = Robert Gravesï¼‰
   - é¸æ“‡é¡å‹ï¼ˆå­—ä¸²æˆ–æ•¸å­—ï¼‰
4. é»æ“Šã€ŒåŒ¯å…¥åˆ°å„²å­˜ç©ºé–“ã€

### 3. æŸ¥è©¢æ¸¬è©¦

1. åˆ‡æ›åˆ°ã€ŒæŸ¥è©¢æ¸¬è©¦ã€åˆ†é 
2. è¼¸å…¥å„²å­˜ç©ºé–“åç¨±ï¼ˆå¤šå€‹å„²å­˜ç©ºé–“ç”¨é€—è™Ÿåˆ†éš”ï¼‰
3. è¼¸å…¥æŸ¥è©¢å…§å®¹ï¼ˆä¾‹å¦‚ï¼šã€Œå¹«æˆ‘æ•´ç†æª”æ¡ˆå…§å®¹æ‘˜è¦çµ¦æˆ‘ã€ï¼‰
4. ï¼ˆé¸å¡«ï¼‰è¼¸å…¥è©®é‡‹è³‡æ–™ç¯©é¸å™¨ï¼ˆä¾‹å¦‚ï¼šã€Œauthor=Robert Gravesã€ï¼‰
5. é»æ“Šã€ŒåŸ·è¡ŒæŸ¥è©¢ã€
6. æª¢è¦–çµæœå’Œå¼•ç”¨è³‡è¨Š

## æ”¯æ´çš„æª”æ¡ˆé¡å‹

æ ¹æ“š Gemini API æ–‡ä»¶ï¼Œæ”¯æ´çš„æª”æ¡ˆé¡å‹åŒ…æ‹¬ï¼š
- æ–‡å­—æª”æ¡ˆï¼ˆ.txt, .md, .srt, etc.ï¼‰
- æ–‡ä»¶æª”æ¡ˆï¼ˆ.pdf, .doc, .docx, etc.ï¼‰
- å…¶ä»–æ‡‰ç”¨ç¨‹å¼æª”æ¡ˆ

æœ€å¤§æª”æ¡ˆå¤§å°ï¼š100MB

## é™åˆ¶

- æ¯å€‹å°ˆæ¡ˆæœ€å¤š 10 å€‹æª”æ¡ˆæœå°‹å„²å­˜ç©ºé–“
- æª”æ¡ˆå¤§å°é™åˆ¶ï¼š100MB
- å„²å­˜ç©ºé–“é™åˆ¶ï¼ˆæ ¹æ“šä½¿ç”¨è€…å±¤ç´šï¼‰ï¼š
  - å…è²»ï¼š1 GB
  - ç¬¬ 1 ç´šï¼š10 GB
  - ç¬¬ 2 ç´šï¼š100 GB
  - ç¬¬ 3 ç´šï¼š1 TB

## å®šåƒ¹

- ç´¢å¼•å»ºç«‹æ™‚ï¼š$0.15 / ç™¾è¬å€‹è©å…ƒï¼ˆåµŒå…¥å®šåƒ¹ï¼‰
- å„²å­˜ç©ºé–“ï¼šå…è²»
- æŸ¥è©¢æ™‚åµŒå…¥ï¼šå…è²»
- æª¢ç´¢çš„æ–‡ä»¶è©å…ƒï¼šæŒ‰æ™®é€šå…§å®¹è©å…ƒè¨ˆè²»

## å°ˆæ¡ˆçµæ§‹

```
gemini-file-sample/
â”œâ”€â”€ app.py                 # Flask å¾Œç«¯ä¼ºæœå™¨
â”œâ”€â”€ requirements.txt       # Python ç›¸ä¾å¥—ä»¶
â”œâ”€â”€ README.md             # å°ˆæ¡ˆèªªæ˜
â”œâ”€â”€ test_query.py         # æŸ¥è©¢æ¸¬è©¦è…³æœ¬
â”œâ”€â”€ test_list_documents.py # æª”æ¡ˆåˆ—è¡¨æ¸¬è©¦è…³æœ¬
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ index.html        # å‰ç«¯ HTML ä»‹é¢
â”œâ”€â”€ static/
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css     # æ¨£å¼æª”æ¡ˆ
â”‚   â””â”€â”€ js/
â”‚       â””â”€â”€ main.js       # JavaScript äº’å‹•é‚è¼¯
â””â”€â”€ uploads/              # è‡¨æ™‚ä¸Šå‚³è³‡æ–™å¤¾ï¼ˆè‡ªå‹•å»ºç«‹ï¼‰
```

## æŠ€è¡“ç´°ç¯€

### API ç«¯é»

- `GET /` - ä¸»é é¢
- `POST /api/create-store` - å»ºç«‹æª”æ¡ˆæœå°‹å„²å­˜ç©ºé–“
- `GET /api/list-stores` - åˆ—å‡ºæ‰€æœ‰å„²å­˜ç©ºé–“
- **`GET /api/list-documents` - åˆ—å‡ºå„²å­˜ç©ºé–“ä¸­çš„æ‰€æœ‰æª”æ¡ˆ**ï¼ˆæ–°åŠŸèƒ½ï¼‰
- `POST /api/delete-store` - åˆªé™¤å„²å­˜ç©ºé–“
- `POST /api/upload-to-store` - ç›´æ¥ä¸Šå‚³æª”æ¡ˆåˆ°å„²å­˜ç©ºé–“
- `POST /api/upload-file` - ä¸Šå‚³æª”æ¡ˆï¼ˆåˆ†æ­¥æ–¹å¼ï¼‰
- `POST /api/import-file` - åŒ¯å…¥æª”æ¡ˆåˆ°å„²å­˜ç©ºé–“
- `POST /api/query` - æŸ¥è©¢å„²å­˜ç©ºé–“

### é—œéµä¿®å¾©è¨˜éŒ„

1. **SDK ç‰ˆæœ¬è¦æ±‚ï¼š** google-genai å¿…é ˆ >= 1.49.0 æ‰æ”¯æ´ `file_search_stores` å±¬æ€§
2. **åƒæ•¸å‘½åï¼š** ä¸Šå‚³è¨­å®šä½¿ç”¨ `display_name` è€Œé `name`
3. **å„²å­˜ç©ºé–“åç¨±æ ¼å¼ï¼š** å¿…é ˆä½¿ç”¨å®Œæ•´æ ¼å¼ `fileSearchStores/xxx`ï¼Œè€Œéç°¡ç¨±
4. **æ¨¡å‹ç‰ˆæœ¬è¦æ±‚ï¼š** File Search åŠŸèƒ½åƒ…æ”¯æ´ `gemini-2.5-flash` æˆ– `gemini-2.5-pro`ï¼Œä¸æ”¯æ´ `gemini-2.0-flash-exp`
5. **Tool çµæ§‹ï¼š** å¿…é ˆä½¿ç”¨ `types.Tool(file_search=types.FileSearch(...))` çµæ§‹

## æ•…éšœæ’é™¤

### API Key éŒ¯èª¤
- ç¢ºä¿åœ¨ç¶²é ã€Œè¨­å®šã€åˆ†é ä¸­è¼¸å…¥æ­£ç¢ºçš„ API Key
- æª¢æŸ¥ç€è¦½å™¨ localStorage æ˜¯å¦æ­£ç¢ºå„²å­˜
- å˜—è©¦æ¸…é™¤ä¸¦é‡æ–°è¼¸å…¥ API Key

### æª”æ¡ˆä¸Šå‚³å¤±æ•—
- æª¢æŸ¥æª”æ¡ˆå¤§å°æ˜¯å¦è¶…é 100MB
- ç¢ºä¿æª”æ¡ˆé¡å‹å—æ”¯æ´
- æª¢æŸ¥ç¶²è·¯é€£ç·š
- **ç¢ºèªå„²å­˜ç©ºé–“åç¨±æ ¼å¼æ­£ç¢º**ï¼ˆå¿…é ˆæ˜¯ `fileSearchStores/xxx`ï¼‰

### æŸ¥è©¢å¤±æ•—
- **ç¢ºèªä½¿ç”¨çš„æ¨¡å‹æ˜¯ `gemini-2.5-flash` æˆ– `gemini-2.5-pro`**
- ç¢ºèªæª”æ¡ˆå·²æˆåŠŸåŒ¯å…¥å„²å­˜ç©ºé–“
- ç­‰å¾…å¹¾ç§’è®“ç´¢å¼•å®Œæˆ
- å˜—è©¦ä¸åŒçš„æŸ¥è©¢å…§å®¹
- æª¢æŸ¥æ“ä½œè¨˜éŒ„äº†è§£è©³ç´°éŒ¯èª¤è¨Šæ¯

### æ“ä½œè¶…æ™‚
- å¤§æª”æ¡ˆå¯èƒ½éœ€è¦æ›´é•·è™•ç†æ™‚é–“
- æª¢æŸ¥æ“ä½œè¨˜éŒ„äº†è§£è©³ç´°è³‡è¨Š
- ä¼ºæœå™¨è¨­å®šæœ€å¤§ç­‰å¾…æ™‚é–“ç‚º 60 ç§’

### google-genai ç‰ˆæœ¬å•é¡Œ
å¦‚æœé‡åˆ° `'Client' object has no attribute 'file_search_stores'` éŒ¯èª¤ï¼š
```bash
pip3 install --upgrade google-genai
# ç¢ºä¿ç‰ˆæœ¬ >= 1.49.0
pip3 show google-genai | grep Version
```

## æŠ€è¡“å †ç–Š

- **å¾Œç«¯**: Flask (Python)
- **å‰ç«¯**: HTML5, CSS3, JavaScript (Vanilla)
- **API**: Google Gemini API (google-genai SDK)
- **å„²å­˜**: ç€è¦½å™¨ localStorageï¼ˆAPI Keyï¼‰

## åƒè€ƒè³‡æ–™

- [Gemini API æª”æ¡ˆæœå°‹æ–‡ä»¶ï¼ˆç¹é«”ä¸­æ–‡ï¼‰](https://ai.google.dev/gemini-api/docs/file-search?hl=zh-tw)
- [Gemini API æª”æ¡ˆæœå°‹æ–‡ä»¶ï¼ˆè‹±æ–‡ï¼‰](https://ai.google.dev/gemini-api/docs/file-search)
- [Google AI Studio](https://aistudio.google.com/)
- [google-genai Python SDK](https://github.com/googleapis/python-genai)

## æˆæ¬Š

MIT License

## è²¢ç»

æ­¡è¿æäº¤ Issue å’Œ Pull Requestï¼

## æ›´æ–°è¨˜éŒ„

### æœ€æ–°ç‰ˆæœ¬
- âœ… **æ–°å¢åˆ—å‡ºå„²å­˜ç©ºé–“æª”æ¡ˆåŠŸèƒ½**ï¼ˆå¯æŸ¥çœ‹æ¯å€‹å„²å­˜ç©ºé–“ä¸­çš„æ‰€æœ‰æª”æ¡ˆï¼‰
- âœ… ä¿®å¾©æŸ¥è©¢åŠŸèƒ½ï¼ˆæ”¹ç”¨ gemini-2.5-flash æ¨¡å‹ï¼‰
- âœ… æ›´æ–° google-genai è‡³ 1.49.0+
- âœ… ä¿®æ­£åƒæ•¸å‘½åï¼ˆdisplay_nameï¼‰
- âœ… æ”¹é€²å„²å­˜ç©ºé–“åç¨±è¤‡è£½åŠŸèƒ½
- âœ… æ–°å¢ç€è¦½å™¨ç«¯ API Key ç®¡ç†
- âœ… å°‡æ‰€æœ‰ä»‹é¢æ”¹ç‚ºç¹é«”ä¸­æ–‡ï¼ˆå°ç£ç”¨èªï¼‰
- âœ… è®Šæ›´é è¨­åŸ è™Ÿç‚º 3000
